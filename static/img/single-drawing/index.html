<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>12promax</title>
    <link rel="stylesheet" href="index.css" />
    <!-- 引入样式文件 -->
    <link rel="stylesheet" href="https://unpkg.com/vant@2.12/lib/index.css" />
    <!-- 引入 Vue 和 Vant 的 JS 文件 -->
    <script src="https://unpkg.com/vue@2.6/dist/vue.min.js"></script>
    <script src="https://unpkg.com/vant@2.12/lib/vant.min.js"></script>
  </head>

  <body>
    <div id="app">
      <div class="aymenu" ref="menuMain">
        <div @touchstart="titleTouchStart" @touchmove="titleTouchMove">
          <van-nav-bar title="和平精英公益单绘制">
            <template #right>
              <van-icon
                @click="closeMenu"
                name="close"
                size="24"
                color="#c1c1c1"
              />
            </template>
          </van-nav-bar>
        </div>
        <div class="menuBody" ref="menuBody">
          <van-cell-group inset>
            <van-cell center title="绘制开关">
              <template #right-icon>
                <van-tabs
                  v-model="checkboxList.isDraw"
                  type="card"
                  style="width: 60%;"
                >
                  <van-tab title="开启" name="1"></van-tab>
                  <van-tab title="关闭" name="2"></van-tab>
                </van-tabs>
              </template>
            </van-cell>
            <van-cell center title="主播模式">
              <template #right-icon>
                <van-tabs
                  v-model="isLive"
                  @change="changeLive"
                  type="card"
                  style="width: 60%;"
                >
                  <van-tab title="开启" name="1"></van-tab>
                  <van-tab title="关闭" name="2"></van-tab>
                </van-tabs>
              </template>
            </van-cell>
          </van-cell-group>

          <br />
          <van-cell-group inset>
            <van-collapse v-model="active" accordion>
              <van-collapse-item title="人物绘制">
                <van-cell center title="射线">
                  <template #right-icon>
                    <van-switch
                      v-model="checkboxList.isLine"
                      size="20"
                      active-color="#34c85a"
                      inactive-color="#e9e9eb"
                    />
                  </template>
                </van-cell>
                <van-cell center title="方框">
                  <template #right-icon>
                    <van-switch
                      v-model="checkboxList.isBox"
                      size="20"
                      active-color="#34c85a"
                      inactive-color="#e9e9eb"
                    />
                  </template>
                </van-cell>
                <van-cell center title="骨骼">
                  <template #right-icon>
                    <van-switch
                      v-model="checkboxList.isBone"
                      size="20"
                      active-color="#34c85a"
                      inactive-color="#e9e9eb"
                    />
                  </template>
                </van-cell>
                <van-cell center title="血量">
                  <template #right-icon>
                    <van-switch
                      v-model="checkboxList.isHP"
                      size="20"
                      active-color="#34c85a"
                      inactive-color="#e9e9eb"
                    />
                  </template>
                </van-cell>
                <van-cell center title="信息">
                  <template #right-icon>
                    <van-switch
                      v-model="checkboxList.isInfo"
                      size="20"
                      active-color="#34c85a"
                      inactive-color="#e9e9eb"
                    />
                  </template>
                </van-cell>
                <van-cell center title="距离">
                  <template #right-icon>
                    <van-switch
                      v-model="checkboxList.isDis"
                      size="20"
                      active-color="#34c85a"
                      inactive-color="#e9e9eb"
                    />
                  </template>
                </van-cell>
                <van-cell center title="手持">
                  <template #right-icon>
                    <van-switch
                      v-model="checkboxList.isShouChi"
                      size="20"
                      active-color="#34c85a"
                      inactive-color="#e9e9eb"
                    />
                  </template>
                </van-cell>
                <van-cell center title="背敌">
                  <template #right-icon>
                    <van-switch
                      v-model="checkboxList.isBeid"
                      size="20"
                      active-color="#34c85a"
                      inactive-color="#e9e9eb"
                    />
                  </template>
                </van-cell>
                <van-cell center title="雷达">
                  <template #right-icon>
                    <van-switch
                      v-model="checkboxList.isleida"
                      size="20"
                      active-color="#34c85a"
                      inactive-color="#e9e9eb"
                    />
                  </template>
                </van-cell>
              </van-collapse-item>
              <van-collapse-item title="物资绘制">
                <van-cell center title="盒子">
                  <template #right-icon>
                    <van-switch
                      v-model="checkboxList.ishezi"
                      size="20"
                      active-color="#34c85a"
                      inactive-color="#e9e9eb"
                    />
                  </template>
                </van-cell>
                <van-cell center title="载具">
                  <template #right-icon>
                    <van-switch
                      v-model="checkboxList.isvehicle"
                      size="20"
                      active-color="#34c85a"
                      inactive-color="#e9e9eb"
                    />
                  </template>
                </van-cell>
                <van-cell center title="耐久">
                  <template #right-icon>
                    <van-switch
                      v-model="naijiu"
                      size="20"
                      active-color="#34c85a"
                      inactive-color="#e9e9eb"
                    />
                  </template>
                </van-cell>
                <van-cell center title="油耗">
                  <template #right-icon>
                    <van-switch
                      v-model="youhao"
                      size="20"
                      active-color="#34c85a"
                      inactive-color="#e9e9eb"
                    />
                  </template>
                </van-cell>
              </van-collapse-item>
            </van-collapse>
          </van-cell-group>

          <br />
          <van-cell-group inset>
            <van-cell center title="手持贴图">
              <template #right-icon>
                <van-tabs v-model="tietu" type="card" style="width: 60%;">
                  <van-tab title="开启" name="1"></van-tab>
                  <van-tab title="关闭" name="2"></van-tab>
                </van-tabs>
              </template>
            </van-cell>
            <van-cell center title="绘制风格">
              <template #right-icon>
                <van-tabs v-model="huizhi" type="card" style="width: 60%;">
                  <van-tab title="经典" name="1"></van-tab>
                  <van-tab title="简洁" name="2"></van-tab>
                </van-tabs>
              </template>
            </van-cell>
            <van-cell center title="骨骼风格">
              <template #right-icon>
                <van-tabs v-model="guge" type="card" style="width: 60%;">
                  <van-tab title="半骨" name="bg"></van-tab>
                  <van-tab title="全骨" name="qg"></van-tab>
                </van-tabs>
              </template>
            </van-cell>
            <van-cell center title="方框风格">
              <template #right-icon>
                <van-tabs v-model="fangkuang" type="card" style="width: 60%;">
                  <van-tab title="普通2D" name="1"></van-tab>
                  <van-tab title="动态3D" name="2"></van-tab>
                </van-tabs>
              </template>
            </van-cell>
            <van-cell center title="绘制帧率">
              <template #right-icon>
                <van-tabs
                  v-model="fps"
                  @change="fuckfps"
                  type="card"
                  style="width: 60%;"
                >
                  <van-tab title="60帧" name="30"></van-tab>
                  <van-tab title="90帧" name="21"></van-tab>
                  <van-tab title="120帧" name="16"></van-tab>
                </van-tabs>
              </template>
            </van-cell>
            <van-collapse v-model="active2" accordion>
              <van-collapse-item title="雷达参数">
                <van-cell center title="雷达X">
                  <template #right-icon>
                    <van-slider
                      v-model="leidaX"
                      :min="0"
                      :max="500"
                      bar-height="3px"
                      style="width: 35%;"
                    >
                    </van-slider
                    >&nbsp;&nbsp;&nbsp;&nbsp;
                    <van-stepper
                      v-model="leidaX"
                      :min="0"
                      :max="500"
                      button-size="26"
                      disable-input
                      integer
                    />
                  </template>
                </van-cell>
                <van-cell center title="雷达Y">
                  <template #right-icon>
                    <van-slider
                      v-model="leidaY"
                      :min="0"
                      :max="200"
                      bar-height="3px"
                      style="width: 35%;"
                    >
                    </van-slider
                    >&nbsp;&nbsp;&nbsp;&nbsp;
                    <van-stepper
                      v-model="leidaY"
                      :min="0"
                      :max="200"
                      button-size="26"
                      disable-input
                      integer
                    />
                  </template>
                </van-cell>
                <van-cell center title="雷达大小">
                  <template #right-icon>
                    <van-tabs v-model="leida" type="card" style="width: 60%;">
                      <van-tab title="大" name="1"></van-tab>
                      <van-tab title="中" name="2"></van-tab>
                      <van-tab title="小" name="3"></van-tab>
                    </van-tabs>
                  </template>
                </van-cell>
              </van-collapse-item>
              <van-collapse-item title="绘图参数">
                <van-cell center title="绘制范围">
                  <template #right-icon>
                    <van-slider
                      v-model="dis"
                      :min="0"
                      :max="500"
                      bar-height="3px"
                      style="width: 63%;"
                    >
                      <template #button>
                        <div class="custom-button">{{dis}}</div>
                      </template>
                    </van-slider>
                  </template>
                </van-cell>
                <van-cell center title="载具范围">
                  <template #right-icon>
                    <van-slider
                      v-model="zaijufw"
                      :min="0"
                      :max="500"
                      bar-height="3px"
                      style="width: 63%;"
                    >
                      <template #button>
                        <div class="custom-button">{{zaijufw}}</div>
                      </template>
                    </van-slider>
                  </template>
                </van-cell>
                <van-cell center title="骨骼范围">
                  <template #right-icon>
                    <van-slider
                      v-model="gugefw"
                      :min="0"
                      :max="500"
                      bar-height="3px"
                      style="width: 60%;"
                    >
                      <template #button>
                        <div class="custom-button">{{gugefw}}</div>
                      </template>
                    </van-slider>
                  </template>
                </van-cell>
                <van-cell center title="观透队标">
                  <template #right-icon>
                    <van-slider
                      v-model="team"
                      :min="0"
                      :max="100"
                      bar-height="3px"
                      style="width: 63%;"
                    >
                      <template #button>
                        <div class="custom-button">{{team}}</div>
                      </template>
                    </van-slider>
                  </template>
                </van-cell>
                <van-cell center title="顶部药丸">
                  <template #right-icon>
                    <van-slider
                      v-model="renshu"
                      :min="0"
                      :max="100"
                      bar-height="3px"
                      style="width: 63%;"
                    >
                      <template #button>
                        <div class="custom-button">{{renshu}}</div>
                      </template>
                    </van-slider>
                  </template>
                </van-cell>
                <van-cell center title="线条粗细">
                  <template #right-icon>
                    <van-stepper
                      v-model="xian"
                      min="1"
                      max="10"
                      theme="round"
                      button-size="22"
                      disable-input
                    />
                  </template>
                </van-cell>
              </van-collapse-item>
            </van-collapse>
          </van-cell-group>
        </div>
      </div>
    </div>
  </body>
  <script>
    let app = new Vue({
      el: "#app",
      data() {
        return {
          active: false,
          active1: false,
          active2: false,
          active3: false,
          active4: false,

          checkboxList: {
            isDraw: "2", //开关
            isLine: true, //射线
            isBox: false, //方框
            isBone: true, //骨骼
            isHP: true, //血量
            isInfo: true, //信息
            isDis: true, //距离
            isShouChi: true, //手持
            isBeid: true, //背敌
            isleida: true, //雷达
            isvehicle: true, //载具
            ishezi: false, //盒子
          },
          naijiu: false, //耐久
          youhao: false, //油耗
          wuhou: false, //无后
          judian: false, //聚点
          jingfang: false, //镜防
          zimiao: false, //辅助瞄准
          zimiaodx: 100, //圈大小
          zimiaojl: 50, //圈距离

          leidaX: 100, //雷达x
          leidaY: 20, //雷达y
          renshu: 40, //人数
          xian: 2, //线条
          isLive: "2", //直播开关
          leida: "3", //雷达大小
          tietu: "2", //贴图开关
          huizhi: "1", //绘制风格
          guge: "bg", //骨骼风格
          fangkuang: "1", //方框风格
          fps: "21", //绘制帧率
          dis: "500", //绘制范围
          zaijufw: "500", //载具范围
          gugefw: "50", //骨骼范围
          team: "0", //观战队标

          teamcolor: {
            //队标颜色
            1: "#DC143C",
            2: "#FFB6C1",
            3: "#FF69B4",
            4: "#FF00FF",
            5: "#7B68EE",
            6: "#F58220",
            7: "#6495ED",
            8: "#1E90FF",
            9: "#426ab3",
            10: "#00FFFF",
            11: "#7FFFD4",
            12: "#90EE90",
            13: "#FFFF00",
            14: "#F0E68C",
            15: "#FFA500",
            16: "#FF8C00",
            17: "#8B4513",
            18: "#FF6347",
            19: "#CD5C5C",
            20: "#C0C0C0",
            21: "#696969",
            22: "#66CDAA",
            23: "#FFD700",
            24: "#FFE4E1",
            25: "#8B008B",
            26: "#5C2223",
            27: "#482936",
            28: "#C45A65",
            29: "#440E25",
            30: "#36292F",
            31: "#5D3F51",
            32: "#681752",
            33: "#3E3841",
            34: "#ED556A",
            35: "#7A7374",
            36: "#EA517F",
            37: "#3161AB",
            38: "#2474B5",
            39: "#93B5CF",
            40: "#2177B8",
            41: "#2D2E36",
            42: "#5E6E6D",
            43: "#61649F",
            44: "#475164",
            45: "#2B333E",
            46: "#15559A",
            47: "#5E7987",
            48: "#74787A",
            49: "#1781B5",
            50: "#BBB5AC",
            51: "#FF9900",
            52: "#AD9E5F",
            53: "#DC9123",
            54: "#97846C",
            55: "#E3BD8D",
            56: "#4D4030",
            57: "#F8C387",
            58: "#FA7E23",
            59: "#E2D849",
            60: "#5E5314",
            61: "#AD9E5F",
            62: "#FED71A",
            63: "#E4BF11",
            64: "#D2B42C",
            65: "#F8DF72",
            66: "#DDC871",
            67: "#93D5DC",
            68: "#57C3C2",
            69: "#1BA784",
            70: "#428675",
            71: "#69A794",
            72: "#FF7F50",
            73: "#E9967A",
            74: "#B8860B",
            75: "#DAA520",
            76: "#F0E68C",
            77: "#9ACD32",
            78: "#00FA9A",
            79: "#66CDAA",
            80: "#2F4F4F",
            81: "#5F9EA0",
            82: "#5F9EA0",
            83: "#6495ED",
            84: "#87CEFA",
            85: "#F5DEB3",
            86: "#FFFACD",
            87: "#D2691E",
            88: "#CD853F",
            89: "#DEB887",
            90: "#BC8F8F",
            91: "#FFDEAD",
            92: "#FFE4E1",
            93: "#FFEFD5",
            94: "#F5FFFA",
            95: "#E6E6FA",
            96: "#F0FFF0",
            97: "#DCDCDC",
            98: "#D8BFD8",
            99: "#B22222",
            100: "#808080",
          },

          zaiju: {
            //载具
            0: "自行车",
            3348: "旅行车",
            3309: "三轮",
            3301: "蹦蹦",
            3305: "吉普",
            3302: "吉普",
            3304: "吉普",
            3306: "轿车",
            3336: "双跑",
            3312: "轿车",
            3314: "皮卡",
            3310: "皮卡",
            3308: "摩托",
            3315: "小绵羊",
            3335: "大脚车",
            3325: "快艇",
            3326: "摩托艇",
            3307: "面包车",
            3342: "越野摩托",
            3329: "装甲车",
            3334: "滑翔机",
            3345: "波波球",
          },

          shouchi: {
            //手持
            0: "拳头",
            101001: "AKM",
            101002: "M16A4",
            101003: "SCAR-L",
            101004: "M416",
            101005: "GROZA",
            101006: "AUG",
            101007: "QBZ",
            101008: "M762",
            101009: "Mk47",
            101010: "G36C",
            101011: "AC-VAL",
            101012: "蜜獾",
            102001: "UZI",
            102003: "Vector",
            102004: "汤姆逊",
            102005: "野牛",
            102007: "MP5K",
            102105: "P90",
            103013: "M417",
            103004: "SKS",
            103006: "Mini14",
            103009: "SLR",
            103005: "VSS",
            103010: "QBU",
            103007: "Mk14",
            103003: "AWM",
            103903: "AWM",
            103002: "M24",
            103011: "莫辛纳甘",
            103901: "Kar98K",
            103001: "Kar98K",
            103008: "Win94",
            103012: "AMR",
            102002: "UMP45",
            104002: "S1897",
            104001: "S686",
            104100: "SPAS-12",
            104004: "DBS",
            104003: "S12K",
            105002: "DP-28",
            107001: "十字弩",
            107006: "战术弩",
            105010: "MG3",
            105001: "M249",
            107007: "爆炸猎弓",
            108004: "平底锅",
            108003: "镰刀",
            108002: "撬棍",
            108001: "大砍刀",
            106001: "P92",
            106002: "P1911",
            106003: "R1895",
            106004: "P18C",
            106005: "R45",
            106006: "散弹手枪",
            106008: "蝎式手枪",
            106010: "沙漠之鹰",
            602004: "手榴弹",
            602001: "震爆弹",
            602002: "烟雾弹",
            602003: "燃烧瓶",
            602075: "铝热弹",
            103014: "MK20-H",
          },
        };
      },
      mounted() {
        this.setRect(370, 355);
      },
      methods: {
        setRect(w, h, x = -1, y = -1) {
          var boxW = w;
          var boxH = h;

          var ayMenu = this.$refs.menuMain;
          ayMenu.style.width = `${boxW}px`;
          ayMenu.style.height = `${boxH}px`;
          if (x == -1) ayMenu.style.left = `calc(50% - ${boxW / 2}px)`;
          if (y == -1) ayMenu.style.top = `calc(50% - ${boxH / 2}px)`;

          var menuBody = this.$refs.menuBody;
          menuBody.style.height = `${boxH - 46 - 40}px`;
        },
        titleTouchStart(event) {
          this.touchStartX = parseInt(event.touches[0].clientX);
          this.touchStartY = parseInt(event.touches[0].clientY);

          var ayMenu = this.$refs.menuMain;
          this.menuLastX = ayMenu.offsetLeft;
          this.menuLastY = ayMenu.offsetTop;
        },
        titleTouchMove(event) {
          event.preventDefault();
          var distanceX = event.touches[0].clientX - this.touchStartX;
          var distanceY = event.touches[0].clientY - this.touchStartY;

          var ayMenu = this.$refs.menuMain;
          ayMenu.style.left = this.menuLastX + distanceX + "px";
          ayMenu.style.top = this.menuLastY + distanceY + "px";
        },

        closeMenu() {
          var menu = document.querySelector("#app");
          menu.style.display = "none";
          setWindowTouch(false);
        },

        shangse() {
          //半火上色
          h5gg.clearResults();
          h5gg.searchNumber(
            "573.70306396484",
            "F32",
            "0x00000000",
            "0x1600000000"
          );
          h5gg.searchNearby("1", "F32", "0x20");
          var count = h5gg.getResultsCount();
          var r = h5gg.getResults(2);
          r = r[1];
          var addr1 = r.address;
          h5gg.setValue(addr1, 99, "F32");
          alert("半火上色开启成功");
        },

        changeLive() {
          if (window.changeLive == 1) {
            window.changeLive = 0;
            let hideView = h5gg.loadPlugin("ayHide", "h5gg_hideview.dylib");
            setButtonImage(
              "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAFpOLgnAAAACXBIWXMAAAsTAAALEwEAmpwYAAALQ2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNy4xLWMwMDAgNzkuOWNjYzRkZSwgMjAyMi8wMy8xNC0xMToyNjoxOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIzLjMgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyMi0wOC0zMFQxNzowMTo0NiswODowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wOS0yMVQxMzo0NjozMiswODowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjItMDktMjFUMTM6NDY6MzIrMDg6MDAiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOmFhNTIyYTk0LWVhZTAtOTA0NC1hY2Q2LTc2NzU4MzFiNmU1OCIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOmM2NGZmN2E5LWE5MjMtMzg0NS1hNTMwLTY5YjQzNTU4NzA0YSIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOmRhMjIzZmNlLTFmN2UtMDk0MC1iOTU1LWI3NGQ2ODgwMTRmOSIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgdGlmZjpPcmllbnRhdGlvbj0iMSIgdGlmZjpYUmVzb2x1dGlvbj0iNzIwMDAwLzEwMDAwIiB0aWZmOllSZXNvbHV0aW9uPSI3MjAwMDAvMTAwMDAiIHRpZmY6UmVzb2x1dGlvblVuaXQ9IjIiIGV4aWY6Q29sb3JTcGFjZT0iNjU1MzUiIGV4aWY6UGl4ZWxYRGltZW5zaW9uPSIxMDI0IiBleGlmOlBpeGVsWURpbWVuc2lvbj0iMTAyNCI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZGEyMjNmY2UtMWY3ZS0wOTQwLWI5NTUtYjc0ZDY4ODAxNGY5IiBzdEV2dDp3aGVuPSIyMDIyLTA4LTMwVDE3OjAxOjQ2KzA4OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjMuMyAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmYyZjFlNWZjLWUzY2MtZDg0NC04MDE1LWZmNjA0MmY4YjlkZiIgc3RFdnQ6d2hlbj0iMjAyMi0wOC0zMVQxMDoyOTo1MSswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIzLjMgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpkZDBhZDI0MC0yNmQ1LWM3NDItYjBiZS0xYmU4NjZiNDZjMWMiIHN0RXZ0OndoZW49IjIwMjItMDgtMzFUMTU6MDM6NTArMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMy4zIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvcG5nIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJkZXJpdmVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJjb252ZXJ0ZWQgZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NzRiZjQ3OTEtZWUyYy0wMTQ3LTkxOTktOGY2YWQzMTRlMjhjIiBzdEV2dDp3aGVuPSIyMDIyLTA4LTMxVDE1OjAzOjUwKzA4OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjMuMyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmFhNTIyYTk0LWVhZTAtOTA0NC1hY2Q2LTc2NzU4MzFiNmU1OCIgc3RFdnQ6d2hlbj0iMjAyMi0wOS0yMVQxMzo0NjozMiswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIzLjMgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpkZDBhZDI0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"
            );
            //关闭过直播
            hideView.changeHidden(0);
            //HOOK源触摸函数，同步过直播view的触摸开关
            let orig_setWindowTouch = setWindowTouch;
            setWindowTouch = function (isTouch) {
              let boolNum = isTouch ? 1 : 0;
              hideView.changeTouch(boolNum);
              orig_setWindowTouch(isTouch);
            };
          } else {
            window.changeLive = 1;
            let hideView = h5gg.loadPlugin("ayHide", "h5gg_hideview.dylib");
            setButtonImage(
              "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEYAAABGCAYAAAEGKdISAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFumlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNy4xLWMwMDAgNzkuOWNjYzRkZSwgMjAyMi8wMy8xNC0xMToyNjoxOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIzLjMgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyMi0wNy0yM1QyMDo1MyswODowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wNy0yM1QyMDo1MyswODowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjItMDctMjNUMjA6NTMrMDg6MDAiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6Nzg0MzIzMzItOGM3NC01NjQ2LTgyMjMtZGE2NTJlNWYwOTdkIiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6YzYwZmE2MzktNGVkNS1jMzQxLTlkZTItMjRkZTE2NmZhZWUwIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6ZWFhNWMwM2MtOGE4NS1kODRjLWJhYzAtMWJmNzE0NDk5ZTdiIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZWFhNWMwM2MtOGE4NS1kODRjLWJhYzAtMWJmNzE0NDk5ZTdiIiBzdEV2dDp3aGVuPSIyMDIyLTA3LTIzVDIwOjUzKzA4OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjMuMyAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjc4NDMyMzMyLThjNzQtNTY0Ni04MjIzLWRhNjUyZTVmMDk3ZCIgc3RFdnQ6d2hlbj0iMjAyMi0wNy0yM1QyMDo1MyswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIzLjMgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pt4h0w4AAADFSURBVHic7dhBCgJBEATBWf//5/EFyV6apQ8RZ2mLVFR87r3nze/1ER50zjmPmB/HHHs2hxx6MfKGHFnjiCOOODJ1ZOyrdsLY5/UEY4oxxZhiTDGmGFOMKavG+HFVjCnGFGOKMcWYYkwxphhTjCnGFGOKMcWYYkwxphhTVo1Z9TfaJqtepU2ECcIEYYIwQZggTBAmCBOECcIEYYIwQZggTBAmCBOECcIEYYIwQZggTBAmCBOECcIEYYIwQZggTBAmCBOECX8I8RXt6l8iOgAAAABJRU5ErkJggg=="
            );
            //开启过直播
            hideView.changeHidden(1);
            //HOOK源触摸函数，同步过直播view的触摸开关
            let orig_setWindowTouch = setWindowTouch;
            setWindowTouch = function (isTouch) {
              let boolNum = isTouch ? 1 : 0;
              hideView.changeTouch(boolNum);
              orig_setWindowTouch(isTouch);
            };
          }
        },

        fuckfps() {
          clearInterval(window.drawTimer);
          window.drawTimer = setInterval(function () {
            if (app.checkboxList.isDraw) {
              console.log("1");
              shadowDraw();
              if (!window.fpscount) window.fpscount = 0;
              if (!window.fpstime) window.fpstime = performance.now();
              window.fpscount++;
              if (performance.now() - window.fpstime > 2000) {
                window.fps = window.fpscount;
                window.fpstime = performance.now();
                window.fpscount = 0;
              }
              ctx.textBaseline = "top";
              ctx.textAlign = "center";
              ctx.font = '40px "Arial, sans-serif"';
              ctx.fillStyle = "aqua";
              if (window.fps) ctx.fillText("FPS: " + window.fps, 150, 50);
            } else {
              clearCtx();
            }
          }, app.fps);
        },
      },
    });

    //脚本放在最后面, body加载完之后再执行
    //激活webkit的button:active
    document.body.addEventListener("touchstart", function () {});
    //设置不可拖动
    setWindowDrag(0, 0, 0, 0);
    //设置按照屏幕像素尺寸绘图(高清模式)
    const iosScale = window.devicePixelRatio;
    let sWidth = 0; //屏幕宽
    let sHeight = 0; //屏幕高
    //创建画布，布满整个屏幕
    let canvasDom = document.createElement("canvas");
    document.body.appendChild(canvasDom);
    canvasDom.style.height = "100%";
    canvasDom.style.width = "100%";
    //获取窗口信息
    const layout = function () {
      //window.orientation是设备握持方向, 不是屏幕显示方向
      if (window.lastorientation == window.orientation) return;
      window.lastorientation = window.orientation;
      //window.screen中的宽高不会随着屏幕旋转更新(只会在初始化的时候固定)
      if (Math.abs(window.orientation) == 90) {
        //横屏模式
        setWindowRect(0, 0, window.screen.height, window.screen.width);
        canvasDom.width = window.screen.height * iosScale;
        canvasDom.height = window.screen.width * iosScale;
        sWidth = window.screen.height;
        sHeight = window.screen.width;
      } else {
        //竖屏模式
        setWindowRect(0, 0, window.screen.width, window.screen.height);
        canvasDom.height = window.screen.height * iosScale;
        canvasDom.width = window.screen.width * iosScale;
        sWidth = window.screen.width;
        sHeight = window.screen.height;
      }
    };

    layout(); //设置旋转屏幕时自动调整布局和画布
    window.addEventListener("orientationchange", layout, false);
    setButtonImage(
      "data:image/png;base64,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"
    );
    //*设置自定义的悬浮按钮图标点击动作
    setButtonAction(function () {
      let menu = document.querySelector("#app");
      if (menu.style.display == "none") {
        menu.style.display = "block";
        //隐藏菜单之后, 设置触控穿透悬浮窗口
        setWindowTouch(true);
      } else {
        menu.style.display = "none";
        //显示菜单之后, 设置触控不可穿透悬浮窗口
        setWindowTouch(false);
      }
    });

    const ctx = canvasDom.getContext("2d");
    setLineWidth(iosScale);
    var fontFamily = " Arial";
    var cacheTimer = null; //数据缓存计时器，减少遍历次数，提高性能
    var drawTimer = null; //绘图计时器，控制帧率
    var actorCache = []; //对象地址缓存
    //获取进程
    let baseAddr = Number(h5gg.getRangesList(0)[0].start); //aslr只读一次，能减少🐔🎱那么一点性能消耗
    let GWorld = 0; //世界全局变量，公用

    function drawCache() {
      if (isNull(GWorld)) return;
      const Level = readLong(GWorld + 0x90); //Level* PersistentLevel
      //LineBatchComponent* LineBatcher
      //LineBatchComponent* ForegroundLineBatcher
      //获取所有对象数组
      const ActorArray = readLong(Level + 0xa0);
      //LineBatchComponent* PersistentLineBatcher
      //GameNetworkManager* NetworkManager
      //获取所有对象的数量
      const ActorCount = readInt(Level + 0xa8);
      const tempArr = [];
      //遍历
      for (let i = 0; i < ActorCount; i++) {
        const actor = readLong(ActorArray + i * 8); // + 0x10
        if (isNull(actor)) continue;
        let nameId = 0;
        nameId = readLong(actor + 0x60c);
        const ides = readFloat(actor + 0xd68)
          .toString()
          .slice(0, 1); //bool bDead;
        if (ides != 2 && nameId != 1) continue;
        const hpmax = readFloat(actor + 0xd08); //float HealthMax;
        if (
          hpmax == 100 ||
          hpmax == 110 ||
          hpmax == 120 ||
          hpmax == 130 ||
          hpmax == 140 ||
          hpmax == 150 ||
          hpmax == 160 ||
          hpmax == 170 ||
          hpmax == 180 ||
          hpmax == 190 ||
          hpmax == 200 ||
          nameId == 1
        ) {
          tempArr.push(actor);
        }
      }
      actorCache = tempArr;
    }

    function shadowDraw() {
      clearCtx();
      //世界地址
      GWorld = readLong(baseAddr + 0xa6ef9d0);
      if (isNull(GWorld)) return;
      //获取自己
      const NetDriver = readLong(GWorld + 0x98); //NetDriver* NetDriver
      const ServerConnection = readLong(NetDriver + 0x78); //NetConnection* ServerConnection
      const localPlayerController = readLong(ServerConnection + 0x98); //STExtraPlayerController* PlayerController;
      //拿到自己的坐标
      const mySelf = readLong(localPlayerController + 0x520); //Pawn* Pawn;
      //if (isNull(mySelf)) return;//注释该行，观战透视
      //拿到我方队伍的坐标
      const teamCopy = readInt(mySelf + 0xa08); //int TeamID
      myTeam = teamCopy <= 100 ? teamCopy : myTeam;
      const playerCameraManager = readLong(localPlayerController + 0x5a8); //PlayerCameraManager* PlayerCameraManager
      if (isNull(playerCameraManager)) return;
      const povAddr = playerCameraManager + 0x1130 + 0x10; //TViewTarget ViewTarget
      const camViewInfo = {
        Location: {
          X: readFloat(povAddr),
          Y: readFloat(povAddr + 4),
          Z: readFloat(povAddr + 4 + 4),
        },
        Rotation: {
          Pitch: readFloat(povAddr + 0x18),
          Yaw: readFloat(povAddr + 0x18 + 4),
          Roll: readFloat(povAddr + 0x18 + 4 + 4),
        },
        FOV: readFloat(povAddr + 0x24),
      };
      //雷达，获取相机旋转视角
      let camAngle = camViewInfo.Rotation.Yaw;
      //一帧只计算一次，减少性能消耗
      const tempMatrix = RotatorToMatrix(camViewInfo.Rotation);

      let playerCout = 0;
      let ai = 0;
      let topEnemy = 0;
      let vehicle = 0;

      for (let i = 0; i < actorCache.length; i++) {
        //排除自己
        const actor = actorCache[i];
        if (mySelf == actor) continue;
        //死亡判断 bDead
        const bDead = readInt(actor + 0xd68);
        if (bDead != 2) continue;
        //排除队友
        const team = readInt(actor + 0xa08); //int TeamID
        if (myTeam == team) continue;
        //排除小黄鸡
        if (team == -1) continue;
        //排除当前观战队伍
        if (team == app.team) continue;
        //最大生命值
        const hpmax = readFloat(actor + 0xd08); //float HealthMax;
        //获取生命值
        const hp = readFloat(actor + 0xd00); //float Health;
        const renhp = (100 * hp) / hpmax;
        //获取人物状态
        const StatusOffset = readInt(actor + 0xd70); //PawnStateRepSyncData PawnStateRepSyncData
        const rootComponent = readLong(actor + 0x258); //SceneComponent* RootComponent
        if (isNull(rootComponent)) continue;

        const worldPos = {
          X: readFloat(rootComponent + 0x1c0),
          Y: readFloat(rootComponent + 0x1c0 + 4),
          Z: readFloat(rootComponent + 0x1c0 + 4 + 4),
        };

        //计算距离
        const distX = (worldPos.X - camViewInfo.Location.X) / 100;
        const distY = (worldPos.Y - camViewInfo.Location.Y) / 100;
        let distance = distX * distX + distY * distY;
        const distZ = (worldPos.Z - camViewInfo.Location.Z) / 100;
        distance = Math.ceil(Math.sqrt(distZ * distZ + distance));
        //敌人yaw  单位：角度
        const angleOffset = readFloat(actor + 0x198);
        //雷达获取敌人世界坐标
        const wradPos = {
          X: distX,
          Y: distY,
          dist: distance,
        };
        const wAngle = (180.0 / Math.PI) * Math.atan2(wradPos.Y, wradPos.X); //雷达，角度相关
        const Angle = camAngle - wAngle + 90; //雷达，角度相关
        const towards = angleOffset - camAngle - 90; //雷达敌人视角朝向

        //雷达获取敌人屏幕坐标
        const radPos = {
          X: wradPos.dist * Math.cos((Angle / 180.0) * Math.PI),
          Y: wradPos.dist * Math.sin((Angle / 180.0) * Math.PI),
        };

        const zb1 = {
          X: worldPos.X,
          Y: worldPos.Y,
          Z: worldPos.Z + 80.0,
        };

        const zb2 = {
          X: worldPos.X,
          Y: worldPos.Y,
          Z: worldPos.Z - 88.0,
        };

        //顶部方框线
        const fkzb1 = world2Screen(zb1, camViewInfo, tempMatrix);
        //底部方框线
        const fkzb2 = world2Screen(zb2, camViewInfo, tempMatrix);
        const fkgao = fkzb2.Y - fkzb1.Y;
        const fkkuan = fkgao / 2;
        //手持枪械
        const lastUpdateStatusKeyListOffset = 0x2978; //LastUpdateStatusKeyList
        const equipWeaponOffset = 0x20; //STExtraWeapon* EquipWeapon
        const weaponOffset = lastUpdateStatusKeyListOffset + equipWeaponOffset;
        const weaponIDOffset = 0x938; //int RepWeaponID
        const my_weapon = readLong(actor + weaponOffset);
        const weaponid = readInt(my_weapon + weaponIDOffset);
        //载具
        const nameId = readLong(actor + 0x604);
        const vehicleid = readLong(actor + 0x16fc)
          .toString()
          .slice(0, 4);
        const vehicleCommonComponent = readLong(actor + 0x9f0); //通用组件 //VehicleCommonComponent* VehicleCommon;
        const vehicleHPMax = readFloat(vehicleCommonComponent + 0x1dc); //最大血量 //float HPMax;
        const vehicleHP = readFloat(vehicleCommonComponent + 0x1e0); //血量 //float HP;
        const cartHP = (100 * vehicleHP) / vehicleHPMax;
        const vehicleFuelMax = readFloat(vehicleCommonComponent + 0x1fc); //最大油量 //float FuelMax;
        const vehicleFuel = readFloat(vehicleCommonComponent + 0x200); //油量 //float Fuel;
        const cartFuel = (100 * vehicleFuel) / vehicleFuelMax;
        if (nameId != 1) {
          const bIsAI = Number(h5gg.getValue(actor + 0xa24, "U8")); //bool bIsAI
          //伞兵计数
          if (StatusOffset == 33554448 || StatusOffset == 33554449)
            topEnemy += 1;
          //读名字可能消耗性能，不需要注释即可⬇️⬇️⬇️⬇️⬇️⬇️
          //只对经典风格生效
          //PlayerName
          let name = "";
          if (app.checkboxList.isInfo) {
            //超出屏幕不计算
            if (
              fkzb1.X > 0 &&
              fkzb1.Y > 0 &&
              fkzb1.X < sWidth &&
              fkzb1.Y < sHeight
            ) {
              const nameAddr = readLong(actor + 0x998);
              name = nameAddr.toString(16);
              if (!isNull(nameAddr)) {
                name = "";
                for (let s = 0; s < 14; s++) {
                  const after = Number(h5gg.getValue(nameAddr + s * 2, "U8"))
                    .toString(16)
                    .padStart(2, "0");
                  const before = Number(
                    h5gg.getValue(nameAddr + s * 2 + 1, "U8")
                  )
                    .toString(16)
                    .padStart(2, "0");
                  const charCode = before + after;
                  if (charCode == "0000") break;
                  name += String.fromCharCode(parseInt(charCode, 16));
                }
              }
            }
          }
          //读名字可能消耗性能，不需要注释即可⬆️⬆️⬆️⬆️⬆️⬆️

          /***************骨骼函数*******************/
          //骨骼函数
          const Mesh = readLong(actor + 0x5a0);
          const human = Mesh + 0x1b0;
          const boneArray = readLong(Mesh + 0x6e0);
          const meshTrans = {
            Rotation: {
              x: readFloat(human),
              y: readFloat(human + 4),
              z: readFloat(human + 8),
              w: readFloat(human + 12),
            },
            Translation: {
              X: readFloat(human + 16),
              Y: readFloat(human + 20),
              Z: readFloat(human + 24),
              W: readFloat(human + 28),
            },
            Scale3D: {
              X: readFloat(human + 32),
              Y: readFloat(human + 36),
              Z: readFloat(human + 40),
            },
          };
          const c2wMatrix = TransformToMatrix(meshTrans);

          let bonetou = {
            X: 0,
            Y: 0,
          };
          let bonebz = {
            X: 0,
            Y: 0,
          };
          let bonezj = {
            X: 0,
            Y: 0,
          };
          let boneyj = {
            X: 0,
            Y: 0,
          };
          let bonezz = {
            X: 0,
            Y: 0,
          };
          let boneyz = {
            X: 0,
            Y: 0,
          };
          let bonezs = {
            X: 0,
            Y: 0,
          };
          let boneys = {
            X: 0,
            Y: 0,
          };
          let bonepg = {
            X: 0,
            Y: 0,
          };
          let bonezp = {
            X: 0,
            Y: 0,
          };
          let boneyp = {
            X: 0,
            Y: 0,
          };
          let bonezx = {
            X: 0,
            Y: 0,
          };
          let boneyx = {
            X: 0,
            Y: 0,
          };
          let bonezjo = {
            X: 0,
            Y: 0,
          };
          let boneyjo = {
            X: 0,
            Y: 0,
          };

          if (app.checkboxList.isBone) {
            //动态骨骼 超出屏幕不计算
            if (
              distance <= app.gugefw &&
              fkzb1.X > 0 &&
              fkzb1.Y > 0 &&
              fkzb1.X < sWidth &&
              fkzb1.Y < sHeight
            ) {
              if (app.guge == "qg") {
                bonetou = getBoneWorldPos(boneArray + 6 * 48, c2wMatrix); //头
                bonebz = getBoneWorldPos(boneArray + 5 * 48, c2wMatrix); //脖子
                bonezj = getBoneWorldPos(boneArray + 12 * 48, c2wMatrix); //左肩
                boneyj = getBoneWorldPos(boneArray + 33 * 48, c2wMatrix); //右肩
                bonezz = getBoneWorldPos(boneArray + 13 * 48, c2wMatrix); //左肘
                boneyz = getBoneWorldPos(boneArray + 34 * 48, c2wMatrix); //右肘
                bonezs = getBoneWorldPos(boneArray + 14 * 48, c2wMatrix); //左手
                boneys = getBoneWorldPos(boneArray + 35 * 48, c2wMatrix); //右手
                bonepg = getBoneWorldPos(boneArray + 1 * 48, c2wMatrix); //骨盆
                bonezx = getBoneWorldPos(boneArray + 54 * 48, c2wMatrix); //左膝盖
                boneyx = getBoneWorldPos(boneArray + 58 * 48, c2wMatrix); //右膝盖
                bonezjo = getBoneWorldPos(boneArray + 55 * 48, c2wMatrix); //左脚
                boneyjo = getBoneWorldPos(boneArray + 59 * 48, c2wMatrix); //右脚
              } else if (app.guge == "bg") {
                bonepg = getBoneWorldPos(boneArray + 1 * 48, c2wMatrix); //骨盆
                bonezx = getBoneWorldPos(boneArray + 54 * 48, c2wMatrix); //左膝盖
                boneyx = getBoneWorldPos(boneArray + 58 * 48, c2wMatrix); //右膝盖
                bonezjo = getBoneWorldPos(boneArray + 55 * 48, c2wMatrix); //左脚
                boneyjo = getBoneWorldPos(boneArray + 59 * 48, c2wMatrix); //右脚
              }
            }
          }
          let dtbonetou = world2Screen(bonetou, camViewInfo, tempMatrix); //头
          let dtbonebz = world2Screen(bonebz, camViewInfo, tempMatrix); //脖子
          let dtbonezj = world2Screen(bonezj, camViewInfo, tempMatrix); //左肩
          let dtboneyj = world2Screen(boneyj, camViewInfo, tempMatrix); //右肩
          let dtbonezz = world2Screen(bonezz, camViewInfo, tempMatrix); //左肘
          let dtboneyz = world2Screen(boneyz, camViewInfo, tempMatrix); //右肘
          let dtbonezs = world2Screen(bonezs, camViewInfo, tempMatrix); //左手
          let dtboneys = world2Screen(boneys, camViewInfo, tempMatrix); //右手
          let dtbonepg = world2Screen(bonepg, camViewInfo, tempMatrix); //骨盆
          let dtbonezx = world2Screen(bonezx, camViewInfo, tempMatrix); //左膝盖
          let dtboneyx = world2Screen(boneyx, camViewInfo, tempMatrix); //右膝盖
          let dtbonezjo = world2Screen(bonezjo, camViewInfo, tempMatrix); //左脚
          let dtboneyjo = world2Screen(boneyjo, camViewInfo, tempMatrix); //右脚
          /***************动态骨骼*******************/

          /***************动态3d框*******************/
          if ((app.checkboxList.isBox && app.fangkuang == "2") || app.zimiao) {
            if (
              distance <= 100 &&
              fkzb1.X > 0 &&
              fkzb1.Y > 0 &&
              fkzb1.X < sWidth &&
              fkzb1.Y < sHeight
            ) {
              bonetou = getBoneWorldPos(boneArray + 6 * 48, c2wMatrix); //头
            }
          }
          let bonetou3d = world2Screen(bonetou, camViewInfo, tempMatrix); //头
          const rwg = 88; //z
          const rwk = 33; //x,y
          const rwk2 = Math.sqrt(2 * rwk * rwk);

          //3d方框上
          const zqs = {
            X:
              worldPos.X +
              rwk2 * Math.cos(((angleOffset + 135) * Math.PI) / 180),
            Y:
              worldPos.Y +
              rwk2 * Math.sin(((angleOffset + 135) * Math.PI) / 180),
            Z: bonetou.Z + 16,
          };
          const yqs = {
            X:
              worldPos.X +
              rwk2 * Math.cos(((angleOffset + 45) * Math.PI) / 180),
            Y:
              worldPos.Y +
              rwk2 * Math.sin(((angleOffset + 45) * Math.PI) / 180),
            Z: bonetou.Z + 16,
          };
          const zhs = {
            X:
              worldPos.X +
              rwk2 * Math.cos(((angleOffset + 225) * Math.PI) / 180),
            Y:
              worldPos.Y +
              rwk2 * Math.sin(((angleOffset + 225) * Math.PI) / 180),
            Z: bonetou.Z + 16,
          };
          const yhs = {
            X:
              worldPos.X +
              rwk2 * Math.cos(((angleOffset + 315) * Math.PI) / 180),
            Y:
              worldPos.Y +
              rwk2 * Math.sin(((angleOffset + 315) * Math.PI) / 180),
            Z: bonetou.Z + 16,
          };

          //3d方框下
          const zqx = {
            X:
              worldPos.X +
              rwk2 * Math.cos(((angleOffset + 135) * Math.PI) / 180),
            Y:
              worldPos.Y +
              rwk2 * Math.sin(((angleOffset + 135) * Math.PI) / 180),
            Z: worldPos.Z - rwg,
          };
          const yqx = {
            X:
              worldPos.X +
              rwk2 * Math.cos(((angleOffset + 45) * Math.PI) / 180),
            Y:
              worldPos.Y +
              rwk2 * Math.sin(((angleOffset + 45) * Math.PI) / 180),
            Z: worldPos.Z - rwg,
          };
          const zhx = {
            X:
              worldPos.X +
              rwk2 * Math.cos(((angleOffset + 225) * Math.PI) / 180),
            Y:
              worldPos.Y +
              rwk2 * Math.sin(((angleOffset + 225) * Math.PI) / 180),
            Z: worldPos.Z - rwg,
          };
          const yhx = {
            X:
              worldPos.X +
              rwk2 * Math.cos(((angleOffset + 315) * Math.PI) / 180),
            Y:
              worldPos.Y +
              rwk2 * Math.sin(((angleOffset + 315) * Math.PI) / 180),
            Z: worldPos.Z - rwg,
          };
          //上
          const zhs1 = world2Screen(zhs, camViewInfo, tempMatrix);
          const yhs1 = world2Screen(yhs, camViewInfo, tempMatrix);
          const zqs1 = world2Screen(zqs, camViewInfo, tempMatrix);
          const yqs1 = world2Screen(yqs, camViewInfo, tempMatrix);
          //下
          const zhx1 = world2Screen(zhx, camViewInfo, tempMatrix);
          const yhx1 = world2Screen(yhx, camViewInfo, tempMatrix);
          const zqx1 = world2Screen(zqx, camViewInfo, tempMatrix);
          const yqx1 = world2Screen(yqx, camViewInfo, tempMatrix);
          /***************3D框*******************/

          //记录要绘制的全部信息
          const actorInfo = {
            x: fkzb1.X, //x坐标
            y: fkzb1.Y, //y坐标
            w: fkkuan, //宽
            h: fkgao, //高
            //hp: hp, //生命值
            hp: renhp, //生命值
            isAI: bIsAI, //是否为机器人
            team: team, //队伍
            name: name, //名字
            dis: distance, //距离
            weaponid: weaponid, //手持枪械
            radx: radPos.X, //雷达x坐标
            rady: radPos.Y, //雷达y坐标
            towards: towards, //人物朝向
            zt: StatusOffset, //人物状态

            //3dx
            zhsx: zhs1.X,
            yhsx: yhs1.X,
            zqsx: zqs1.X,
            yqsx: yqs1.X,

            zhxx: zhx1.X,
            yhxx: yhx1.X,
            zqxx: zqx1.X,
            yqxx: yqx1.X,

            //3dy
            zhsy: zhs1.Y,
            yhsy: yhs1.Y,
            zqsy: zqs1.Y,
            yqsy: yqs1.Y,

            zhxy: zhx1.Y,
            yhxy: yhx1.Y,
            zqxy: zqx1.Y,
            yqxy: yqx1.Y,
            toux: bonetou3d.X,
            touy: bonetou3d.Y,

            //动态骨骼
            bonetoux: dtbonetou.X,
            bonetouy: dtbonetou.Y,
            bonebzx: dtbonebz.X,
            bonebzy: dtbonebz.Y,
            bonezjx: dtbonezj.X,
            bonezjy: dtbonezj.Y,
            boneyjx: dtboneyj.X,
            boneyjy: dtboneyj.Y,
            bonezzx: dtbonezz.X,
            bonezzy: dtbonezz.Y,
            boneyzx: dtboneyz.X,
            boneyzy: dtboneyz.Y,
            bonezsx: dtbonezs.X,
            bonezsy: dtbonezs.Y,
            boneysx: dtboneys.X,
            boneysy: dtboneys.Y,
            bonepgx: dtbonepg.X,
            bonepgy: dtbonepg.Y,
            bonezxx: dtbonezx.X,
            bonezxy: dtbonezx.Y,
            boneyxx: dtboneyx.X,
            boneyxy: dtboneyx.Y,
            bonezjox: dtbonezjo.X,
            bonezjoy: dtbonezjo.Y,
            boneyjox: dtboneyjo.X,
            boneyjoy: dtboneyjo.Y,
          };
          if (distance < app.dis) {
            //可调绘制范围
            shadowInfo(actorInfo);
          }
          if (bIsAI) {
            ai++;
          } else {
            playerCout++;
          }
        } else {
          //载具
          if (app.checkboxList.isvehicle) {
            if (app.huizhi == "1") color = "white";
            if (app.huizhi == "2") color = "yellow";
            if (
              cartHP > 0 &&
              distance > 10 &&
              distance <= app.zaijufw &&
              fkzb1.X > 0 &&
              fkzb1.Y > 0 &&
              fkzb1.X < sWidth &&
              fkzb1.Y < sHeight
            ) {
              //类型
              const zaiju = app.zaiju[vehicleid];
              drawText(
                zaiju + `[${distance}m]`,
                fkzb1.X,
                fkzb1.Y - 10,
                10,
                color,
                "center",
                true
              );
              //耐久
              if (app.naijiu) {
                drawCircular(
                  fkzb1.X - 9,
                  fkzb1.Y + 20,
                  Math.ceil(cartHP),
                  7,
                  "#28ff1d",
                  3,
                  false
                );
                drawText(
                  "🩸",
                  fkzb1.X - 9,
                  fkzb1.Y + 9,
                  7,
                  "yellow",
                  "center",
                  true
                );
              }
              //油量
              if (app.youhao) {
                drawCircular(
                  fkzb1.X + 9,
                  fkzb1.Y + 20,
                  Math.ceil(cartFuel),
                  7,
                  "#28ff1d",
                  3,
                  false
                );
                drawText(
                  "🛢️",
                  fkzb1.X + 9,
                  fkzb1.Y + 9,
                  7,
                  "yellow",
                  "center",
                  true
                );
              }
            }
          }
          vehicle++;
        }
      }

      //伞兵
      if (topEnemy > 0) {
        drawText(
          `⚠️空降敌人: ${topEnemy}`,
          sWidth / 2,
          sHeight / 8,
          22,
          "yellow",
          "center",
          true
        );
      }
      //人数统计
      drawRoundRect(
        sWidth / 2 - 90,
        0 + app.renshu,
        180,
        38,
        20,
        "rgba(255,255,255,0.5)",
        true
      ); //利用圆角矩形填充
      if (playerCout + ai > 0) {
        drawText(
          "⚠️",
          sWidth / 2,
          -30 + app.renshu,
          32,
          "white",
          "center",
          true
        );
      }
      if (playerCout + ai < 1) {
        drawText(
          "♻️",
          sWidth / 2,
          -30 + app.renshu,
          32,
          "white",
          "center",
          true
        );
      }
      drawText(
        "🧛🏻",
        sWidth / 2 - 60,
        -25 + app.renshu,
        28,
        "white",
        "center",
        true
      );
      drawText(
        "🤖",
        sWidth / 2 + 62,
        -25 + app.renshu,
        28,
        "white",
        "center",
        true
      );
      //真人总数
      drawText(
        playerCout,
        sWidth / 2 - 30,
        -20 + app.renshu,
        25,
        playerCout > 0 ? "#f00" : "white",
        "center",
        true
      );
      //人机总数
      drawText(
        ai,
        sWidth / 2 + 32,
        -20 + app.renshu,
        25,
        ai > 0 ? "lime" : "white",
        "center",
        true
      );

      //雷达
      if (app.checkboxList.isleida) {
        if (app.leida == "1") {
          //雷达大
          //起点xy，矩形宽高，颜色，是否填充矩形
          drawCircular(
            100 + app.leidaX,
            100 + app.leidaY,
            100,
            100,
            "rgba(0,0,0,0.15)",
            true
          ); //大圈圈圆形填充
          drawCircular(
            100 + app.leidaX,
            100 + app.leidaY,
            100,
            100,
            "red",
            2,
            false
          ); //大圈圈
          drawCircular(
            100 + app.leidaX,
            100 + app.leidaY,
            100,
            60,
            "aqua",
            2,
            false
          ); //小圈圈
          drawLine(
            0 + app.leidaX,
            100 + app.leidaY,
            200 + app.leidaX,
            100 + app.leidaY,
            "#13ce66",
            2
          ); //横线 起始点xy，终点xy，颜色
          drawLine(
            100 + app.leidaX,
            100 + app.leidaY,
            100 + app.leidaX,
            200 + app.leidaY,
            "#13ce66",
            2
          ); //竖线
          drawLine(
            30 + app.leidaX,
            30 + app.leidaY,
            100 + app.leidaX,
            100 + app.leidaY,
            "red",
            2
          ); //左竖斜线
          drawLine(
            170 + app.leidaX,
            30 + app.leidaY,
            100 + app.leidaX,
            100 + app.leidaY,
            "red",
            2
          ); //右竖斜线
        } else if (app.leida == "2") {
          //雷达中
          //起点xy，矩形宽高，颜色，是否填充矩形
          drawCircular(
            80 + app.leidaX,
            80 + app.leidaY,
            100,
            80,
            "rgba(0,0,0,0.15)",
            2
          ); //大圈圈圆形填充
          drawCircular(
            80 + app.leidaX,
            80 + app.leidaY,
            100,
            80,
            "red",
            2,
            false
          ); //大圈圈
          drawCircular(
            80 + app.leidaX,
            80 + app.leidaY,
            100,
            48,
            "aqua",
            2,
            false
          ); //小圈圈
          drawLine(
            0 + app.leidaX,
            80 + app.leidaY,
            160 + app.leidaX,
            80 + app.leidaY,
            "#13ce66",
            2
          ); //横线 起始点xy，终点xy，颜色
          drawLine(
            80 + app.leidaX,
            80 + app.leidaY,
            80 + app.leidaX,
            160 + app.leidaY,
            "#13ce66",
            2
          ); //竖线
          drawLine(
            24 + app.leidaX,
            24 + app.leidaY,
            80 + app.leidaX,
            80 + app.leidaY,
            "red",
            2
          ); //左竖斜线
          drawLine(
            136 + app.leidaX,
            24 + app.leidaY,
            80 + app.leidaX,
            80 + app.leidaY,
            "red",
            2
          ); //右竖斜线
        } else if (app.leida == "3") {
          //雷达小
          //起点xy，矩形宽高，颜色，是否填充矩形
          drawCircular(
            60 + app.leidaX,
            60 + app.leidaY,
            100,
            60,
            "rgba(0,0,0,0.15)",
            true
          ); //大圈圈圆形填充
          drawCircular(
            60 + app.leidaX,
            60 + app.leidaY,
            100,
            60,
            "red",
            2,
            false
          ); //大圈圈
          drawCircular(
            60 + app.leidaX,
            60 + app.leidaY,
            100,
            36,
            "aqua",
            2,
            false
          ); //小圈圈
          drawLine(
            0 + app.leidaX,
            60 + app.leidaY,
            120 + app.leidaX,
            60 + app.leidaY,
            "#13ce66",
            2
          ); //横线 起始点xy，终点xy，颜色
          drawLine(
            60 + app.leidaX,
            60 + app.leidaY,
            60 + app.leidaX,
            120 + app.leidaY,
            "#13ce66",
            2
          ); //竖线
          drawLine(
            18 + app.leidaX,
            18 + app.leidaY,
            60 + app.leidaX,
            60 + app.leidaY,
            "red",
            2
          ); //左竖斜线
          drawLine(
            102 + app.leidaX,
            18 + app.leidaY,
            60 + app.leidaX,
            60 + app.leidaY,
            "red",
            2
          ); //右竖斜线
        }
      }
    }

    function shadowInfo(objectInfo) {
      //人机判断 是的话对标变为AI
      if (objectInfo.isAI) objectInfo.team = "AI";

      //雷达
      if (app.checkboxList.isleida) {
        if (app.leida == "1") {
          //雷达大
          if (objectInfo.dis < 340) {
            //绘制圆形带箭头 中心点xy,半径, 箭头旋转角度, 圆形颜色，箭头颜色（雷达点朝向）
            drawCMark(
              objectInfo.radx / 3.5 + 100 + app.leidaX,
              -objectInfo.rady / 3.5 + 100 + app.leidaY,
              4,
              objectInfo.towards,
              objectInfo.hp <= 0 ? "white" : objectInfo.isAI ? "lime" : "red",
              "white"
            );
          }
        } else if (app.leida == "2") {
          //雷达中
          if (objectInfo.dis < 340) {
            drawCMark(
              objectInfo.radx / 4.4 + 80 + app.leidaX,
              -objectInfo.rady / 4.4 + 80 + app.leidaY,
              3.2,
              objectInfo.towards,
              objectInfo.hp <= 0 ? "white" : objectInfo.isAI ? "lime" : "red",
              "white"
            );
          }
        } else if (app.leida == "3") {
          //雷达小
          if (objectInfo.dis < 340) {
            drawCMark(
              objectInfo.radx / 5.8 + 60 + app.leidaX,
              -objectInfo.rady / 5.8 + 60 + app.leidaY,
              2.4,
              objectInfo.towards,
              objectInfo.hp <= 0 ? "white" : objectInfo.isAI ? "lime" : "red",
              "white"
            );
          }
        }
      }

      //射线
      if (app.checkboxList.isLine) {
        if (app.huizhi == "1") color = "white";
        if (app.huizhi == "1" && objectInfo.isAI) color = "#28ff1d";
        if (app.huizhi == "2") color = "#28ff1d";
        if (app.huizhi == "2" && objectInfo.isAI) color = "white";
        if (objectInfo.hp > 0) {
          if (app.huizhi == "1" && app.tietu == "1") {
            drawLine(
              sWidth / 2,
              34 + app.renshu,
              objectInfo.x,
              objectInfo.y - 62,
              color,
              2
            );
          } else if (
            app.huizhi == "2" ||
            (app.huizhi == "1" && app.tietu == "2")
          ) {
            drawLine(
              sWidth / 2,
              34 + app.renshu,
              objectInfo.x,
              objectInfo.y - 44,
              color,
              2
            );
          }
        }
      }

      //自瞄绘图
      if (app.zimiao) {
        //圆圈
        drawCircular(
          sWidth / 2,
          sHeight / 2,
          100,
          app.zimiaodx,
          "red",
          1,
          false
        );
        if (
          objectInfo.dis <= app.zimiaojl &&
          objectInfo.x > 0 &&
          objectInfo.y > 0 &&
          objectInfo.x < sWidth &&
          objectInfo.y < sHeight
        ) {
          //线条
          drawLine(
            objectInfo.toux,
            objectInfo.touy,
            sWidth / 2,
            sHeight / 2,
            "aqua",
            2
          );
        }
      }

      //超出屏幕只绘制射线 背敌
      if (
        objectInfo.x < 0 ||
        objectInfo.y < 0 ||
        objectInfo.x > sWidth ||
        objectInfo.y > sHeight
      ) {
        // 背敌
        if (app.checkboxList.isBeid) {
          if (objectInfo.x < 0) objectInfo.x = 20;
          if (objectInfo.y < 0) objectInfo.y = 20;
          if (objectInfo.x > sWidth) objectInfo.x = sWidth - 20;
          if (objectInfo.y > sHeight) objectInfo.y = sHeight - 20;
          drawCircular(
            objectInfo.x,
            objectInfo.y,
            100,
            15,
            objectInfo.isAI ? "rgba(0,255,0,0.6)" : "rgba(255,0,0,0.6)",
            true
          );
          drawText(
            `${objectInfo.dis}m`,
            objectInfo.x,
            objectInfo.y - 16,
            10,
            "white",
            "center",
            true
          );
        }
        return;
      }

      //绘制风格
      if (app.huizhi == "1") {
        //方框
        if (app.checkboxList.isBox) {
          //方框风格
          if (app.fangkuang == "1") {
            //2D巡查方框
            drawMyRect(
              objectInfo.x - objectInfo.w / 2,
              objectInfo.y,
              objectInfo.w,
              objectInfo.h,
              objectInfo.hp <= 0 ? "yellow" : "#00ffff",
              false
            );
          } else if (app.fangkuang == "2") {
            //动态3D方框 距离小于100米绘制3d框
            if (objectInfo.dis <= 100) {
              //上
              drawLine(
                objectInfo.yqsx,
                objectInfo.yqsy,
                objectInfo.zqsx,
                objectInfo.zqsy,
                objectInfo.hp <= 0 ? "yellow" : "white",
                app.xian
              );
              drawLine(
                objectInfo.zqsx,
                objectInfo.zqsy,
                objectInfo.zhsx,
                objectInfo.zhsy,
                objectInfo.hp <= 0 ? "yellow" : "white",
                app.xian
              );
              drawLine(
                objectInfo.zhsx,
                objectInfo.zhsy,
                objectInfo.yhsx,
                objectInfo.yhsy,
                objectInfo.hp <= 0 ? "yellow" : "white",
                app.xian
              );
              drawLine(
                objectInfo.yhsx,
                objectInfo.yhsy,
                objectInfo.yqsx,
                objectInfo.yqsy,
                objectInfo.isAI ? "lime" : "red",
                app.xian
              );
              //下
              drawLine(
                objectInfo.yqxx,
                objectInfo.yqxy,
                objectInfo.zqxx,
                objectInfo.zqxy,
                objectInfo.hp <= 0 ? "yellow" : "white",
                app.xian
              );
              drawLine(
                objectInfo.zqxx,
                objectInfo.zqxy,
                objectInfo.zhxx,
                objectInfo.zhxy,
                objectInfo.hp <= 0 ? "yellow" : "white",
                app.xian
              );
              drawLine(
                objectInfo.zhxx,
                objectInfo.zhxy,
                objectInfo.yhxx,
                objectInfo.yhxy,
                objectInfo.hp <= 0 ? "yellow" : "white",
                app.xian
              );
              drawLine(
                objectInfo.yhxx,
                objectInfo.yhxy,
                objectInfo.yqxx,
                objectInfo.yqxy,
                objectInfo.isAI ? "lime" : "red",
                app.xian
              );
              //从上到下
              drawLine(
                objectInfo.zhsx,
                objectInfo.zhsy,
                objectInfo.zhxx,
                objectInfo.zhxy,
                objectInfo.hp <= 0 ? "yellow" : "white",
                app.xian
              );
              drawLine(
                objectInfo.yhsx,
                objectInfo.yhsy,
                objectInfo.yhxx,
                objectInfo.yhxy,
                objectInfo.isAI ? "lime" : "red",
                app.xian
              );
              drawLine(
                objectInfo.zqsx,
                objectInfo.zqsy,
                objectInfo.zqxx,
                objectInfo.zqxy,
                objectInfo.hp <= 0 ? "yellow" : "white",
                app.xian
              );
              drawLine(
                objectInfo.yqsx,
                objectInfo.yqsy,
                objectInfo.yqxx,
                objectInfo.yqxy,
                objectInfo.isAI ? "lime" : "red",
                app.xian
              );
              //距离大于100米绘制2d框
            } else if (objectInfo.dis > 100) {
              //drawMyRect(objectInfo.x - objectInfo.w / 2, objectInfo.y, objectInfo.w, objectInfo.h, objectInfo.hp <= 0 ? "yellow" : objectInfo.isAI ? "lime" : "#00ffff", false);
              drawRect(
                objectInfo.x - objectInfo.w / 2,
                objectInfo.y,
                objectInfo.w,
                objectInfo.h,
                objectInfo.hp <= 0
                  ? "yellow"
                  : objectInfo.isAI
                  ? "lime"
                  : "red",
                false,
                app.xian
              );
            }
          }
        }

        //骨骼
        if (app.checkboxList.isBone) {
          if (objectInfo.dis <= app.gugefw) {
            //动态全骨
            if (app.guge == "qg") {
              //drawCircular(objectInfo.bonetoux, objectInfo.bonetouy - 1, 100, objectInfo.w/9, 'yellow', false);
              drawLine(
                objectInfo.bonetoux,
                objectInfo.bonetouy,
                objectInfo.bonebzx,
                objectInfo.bonebzy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.bonebzx,
                objectInfo.bonebzy,
                objectInfo.bonezjx,
                objectInfo.bonezjy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.bonebzx,
                objectInfo.bonebzy,
                objectInfo.boneyjx,
                objectInfo.boneyjy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.bonezjx,
                objectInfo.bonezjy,
                objectInfo.bonezzx,
                objectInfo.bonezzy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.boneyjx,
                objectInfo.boneyjy,
                objectInfo.boneyzx,
                objectInfo.boneyzy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.bonezzx,
                objectInfo.bonezzy,
                objectInfo.bonezsx,
                objectInfo.bonezsy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.boneyzx,
                objectInfo.boneyzy,
                objectInfo.boneysx,
                objectInfo.boneysy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.bonebzx,
                objectInfo.bonebzy,
                objectInfo.bonepgx,
                objectInfo.bonepgy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.bonepgx,
                objectInfo.bonepgy,
                objectInfo.bonezxx,
                objectInfo.bonezxy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.bonezxx,
                objectInfo.bonezxy,
                objectInfo.bonezjox,
                objectInfo.bonezjoy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.bonepgx,
                objectInfo.bonepgy,
                objectInfo.boneyxx,
                objectInfo.boneyxy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.boneyxx,
                objectInfo.boneyxy,
                objectInfo.boneyjox,
                objectInfo.boneyjoy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              //动态半骨
            } else if (app.guge == "bg") {
              drawLine(
                objectInfo.bonepgx,
                objectInfo.bonepgy,
                objectInfo.bonezxx,
                objectInfo.bonezxy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.bonezxx,
                objectInfo.bonezxy,
                objectInfo.bonezjox,
                objectInfo.bonezjoy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.bonepgx,
                objectInfo.bonepgy,
                objectInfo.boneyxx,
                objectInfo.boneyxy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.boneyxx,
                objectInfo.boneyxy,
                objectInfo.boneyjox,
                objectInfo.boneyjoy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
            }
          } else if (objectInfo.dis > app.gugefw) {
            //巡查2D方框
            drawMyRect(
              objectInfo.x - objectInfo.w / 2,
              objectInfo.y,
              objectInfo.w,
              objectInfo.h,
              objectInfo.hp <= 0 ? "yellow" : "#00ffff",
              false
            );
          }
        }

        //距离
        if (app.checkboxList.isDis) {
          drawText(
            "[" + objectInfo.dis + "m]",
            objectInfo.x,
            objectInfo.y - 53,
            10,
            "white",
            "right",
            true
          );
        }

        //信息
        if (app.checkboxList.isInfo) {
          const teamcolor = app.teamcolor[objectInfo.team];
          //倒三角形 开始点，x,y 途径，x,y 终点，x,y
          drawTriangle(
            objectInfo.x - 3,
            objectInfo.y - 12,
            objectInfo.x,
            objectInfo.y - 6,
            objectInfo.x + 3,
            objectInfo.y - 12,
            teamcolor,
            0.5,
            true
          );
          //队标背景
          drawRectangle(
            objectInfo.x - 46,
            objectInfo.y - 29,
            16,
            14,
            teamcolor,
            0.8,
            true
          );
          //名字背景
          drawRectangle(
            objectInfo.x - 30,
            objectInfo.y - 29,
            75,
            14,
            teamcolor,
            0.5,
            true
          );
          //队标文字
          drawText(
            objectInfo.team,
            objectInfo.x - 38,
            objectInfo.y - 38,
            10,
            "#FFF",
            "center",
            true
          );
          //名字文字
          if (objectInfo.name.length > 7)
            objectInfo.name = `${objectInfo.name.slice(0, 6)}...`;
          drawText(
            objectInfo.name,
            objectInfo.x + 8,
            objectInfo.y - 38,
            10,
            "#FFF",
            "center",
            true
          );
        }

        //血量
        if (app.checkboxList.isHP) {
          //绘制圆角矩形，起点xy，矩形宽高，圆角半径，颜色，是否填充矩形
          drawRoundRect(
            objectInfo.x - 46,
            objectInfo.y - 15,
            91,
            3,
            0,
            "rgba(0,0,0,0.4)",
            true
          ); //利用实心矩形填充
          drawRoundRect(
            objectInfo.x - 46,
            objectInfo.y - 15,
            Math.ceil(objectInfo.hp / 1.1),
            3,
            0,
            objectInfo.hp <= 30 ? "rgba(255,0,0,0.8)" : "rgba(255,255,255,0.8)",
            true
          );
        }

        //手持贴图
        if (app.tietu == "1") {
          var pngY = "60";
          if (
            app.checkboxList.isLine == false &&
            app.checkboxList.isShouChi == false &&
            app.checkboxList.isDis == false
          )
            pngY = "48";
          //新贴图
          //获取枪械图标
          var img = new Image();
          img.src = "Map/" + app.shouchi[objectInfo.weaponid] + ".png";
          //绘制枪械图标
          circleImgTwo(img, objectInfo.x - 28, objectInfo.y - pngY, 56, 16);
        }

        //手持
        if (app.checkboxList.isShouChi) {
          //贴图
          /*const shouchi2 = app.shouchi2[objectInfo.weaponid];
          if (app.tietu == '1') {
          drawImage(shouchi2, objectInfo.x - 22, objectInfo.y - 63, 44, 23, true);//(路径，路径，位置，宽高)
          }*/
          //文字
          //drawText("[" + objectInfo.weaponid + "m]", objectInfo.x, objectInfo.y - 63, 10, "white", "right", true);
          const shouchi = app.shouchi[objectInfo.weaponid];
          if (objectInfo.hp > 0) {
            drawText(
              "[" + shouchi + "]",
              objectInfo.x,
              objectInfo.y - 53,
              10,
              "white",
              "left",
              true
            );
          } else if (objectInfo.hp <= 0) {
            drawText(
              "[倒地]",
              objectInfo.x,
              objectInfo.y - 53,
              10,
              "white",
              "left",
              true
            );
          }
        }
      } else if (app.huizhi == "2") {
        //方框
        if (app.checkboxList.isBox) {
          //方框风格
          if (app.fangkuang == "1") {
            //巡查2D方框
            drawMyRect(
              objectInfo.x - objectInfo.w / 2,
              objectInfo.y,
              objectInfo.w,
              objectInfo.h,
              objectInfo.hp <= 0 ? "yellow" : "#00ffff",
              false
            );
          } else if (app.fangkuang == "2") {
            //动态3D方框 距离小于100米绘制3d框
            if (objectInfo.dis <= 100) {
              //上
              drawLine(
                objectInfo.yqsx,
                objectInfo.yqsy,
                objectInfo.zqsx,
                objectInfo.zqsy,
                objectInfo.hp <= 0 ? "yellow" : "#28ff1d",
                app.xian
              );
              drawLine(
                objectInfo.zqsx,
                objectInfo.zqsy,
                objectInfo.zhsx,
                objectInfo.zhsy,
                objectInfo.hp <= 0 ? "yellow" : "#28ff1d",
                app.xian
              );
              drawLine(
                objectInfo.zhsx,
                objectInfo.zhsy,
                objectInfo.yhsx,
                objectInfo.yhsy,
                objectInfo.hp <= 0 ? "yellow" : "#28ff1d",
                app.xian
              );
              drawLine(
                objectInfo.yhsx,
                objectInfo.yhsy,
                objectInfo.yqsx,
                objectInfo.yqsy,
                objectInfo.isAI ? "white" : "red",
                app.xian
              );
              //下
              drawLine(
                objectInfo.yqxx,
                objectInfo.yqxy,
                objectInfo.zqxx,
                objectInfo.zqxy,
                objectInfo.hp <= 0 ? "yellow" : "#28ff1d",
                app.xian
              );
              drawLine(
                objectInfo.zqxx,
                objectInfo.zqxy,
                objectInfo.zhxx,
                objectInfo.zhxy,
                objectInfo.hp <= 0 ? "yellow" : "#28ff1d",
                app.xian
              );
              drawLine(
                objectInfo.zhxx,
                objectInfo.zhxy,
                objectInfo.yhxx,
                objectInfo.yhxy,
                objectInfo.hp <= 0 ? "yellow" : "#28ff1d",
                app.xian
              );
              drawLine(
                objectInfo.yhxx,
                objectInfo.yhxy,
                objectInfo.yqxx,
                objectInfo.yqxy,
                objectInfo.isAI ? "white" : "red",
                app.xian
              );
              //从上到下
              drawLine(
                objectInfo.zhsx,
                objectInfo.zhsy,
                objectInfo.zhxx,
                objectInfo.zhxy,
                objectInfo.hp <= 0 ? "yellow" : "#28ff1d",
                app.xian
              );
              drawLine(
                objectInfo.yhsx,
                objectInfo.yhsy,
                objectInfo.yhxx,
                objectInfo.yhxy,
                objectInfo.isAI ? "white" : "red",
                app.xian
              );
              drawLine(
                objectInfo.zqsx,
                objectInfo.zqsy,
                objectInfo.zqxx,
                objectInfo.zqxy,
                objectInfo.hp <= 0 ? "yellow" : "#28ff1d",
                app.xian
              );
              drawLine(
                objectInfo.yqsx,
                objectInfo.yqsy,
                objectInfo.yqxx,
                objectInfo.yqxy,
                objectInfo.isAI ? "white" : "red",
                app.xian
              );
              //大于100米绘制2d框
            } else if (objectInfo.dis > 100) {
              //drawMyRect(objectInfo.x - objectInfo.w / 2, objectInfo.y, objectInfo.w, objectInfo.h, objectInfo.hp <= 0 ? "yellow" : objectInfo.isAI ? "white" : "#00ffff", false);
              drawRect(
                objectInfo.x - objectInfo.w / 2,
                objectInfo.y,
                objectInfo.w,
                objectInfo.h,
                objectInfo.hp <= 0
                  ? "yellow"
                  : objectInfo.isAI
                  ? "white"
                  : "#28ff1d",
                false,
                app.xian
              );
            }
          }
        }

        //骨骼
        if (app.checkboxList.isBone) {
          if (objectInfo.dis <= app.gugefw) {
            //动态全骨
            if (app.guge == "qg") {
              //drawCircular(objectInfo.bonetoux, objectInfo.bonetouy - 1, 100, objectInfo.w/9, 'yellow', false);
              drawLine(
                objectInfo.bonetoux,
                objectInfo.bonetouy,
                objectInfo.bonebzx,
                objectInfo.bonebzy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.bonebzx,
                objectInfo.bonebzy,
                objectInfo.bonezjx,
                objectInfo.bonezjy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.bonebzx,
                objectInfo.bonebzy,
                objectInfo.boneyjx,
                objectInfo.boneyjy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.bonezjx,
                objectInfo.bonezjy,
                objectInfo.bonezzx,
                objectInfo.bonezzy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.boneyjx,
                objectInfo.boneyjy,
                objectInfo.boneyzx,
                objectInfo.boneyzy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.bonezzx,
                objectInfo.bonezzy,
                objectInfo.bonezsx,
                objectInfo.bonezsy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.boneyzx,
                objectInfo.boneyzy,
                objectInfo.boneysx,
                objectInfo.boneysy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.bonebzx,
                objectInfo.bonebzy,
                objectInfo.bonepgx,
                objectInfo.bonepgy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.bonepgx,
                objectInfo.bonepgy,
                objectInfo.bonezxx,
                objectInfo.bonezxy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.bonezxx,
                objectInfo.bonezxy,
                objectInfo.bonezjox,
                objectInfo.bonezjoy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.bonepgx,
                objectInfo.bonepgy,
                objectInfo.boneyxx,
                objectInfo.boneyxy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.boneyxx,
                objectInfo.boneyxy,
                objectInfo.boneyjox,
                objectInfo.boneyjoy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              //动态半骨
            } else if (app.guge == "bg") {
              drawLine(
                objectInfo.bonepgx,
                objectInfo.bonepgy,
                objectInfo.bonezxx,
                objectInfo.bonezxy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.bonezxx,
                objectInfo.bonezxy,
                objectInfo.bonezjox,
                objectInfo.bonezjoy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.bonepgx,
                objectInfo.bonepgy,
                objectInfo.boneyxx,
                objectInfo.boneyxy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
              drawLine(
                objectInfo.boneyxx,
                objectInfo.boneyxy,
                objectInfo.boneyjox,
                objectInfo.boneyjoy,
                objectInfo.isAI ? "white" : "yellow",
                app.xian
              );
            }
          } else if (objectInfo.dis > app.gugefw) {
            //巡查2D方框
            drawMyRect(
              objectInfo.x - objectInfo.w / 2,
              objectInfo.y,
              objectInfo.w,
              objectInfo.h,
              objectInfo.hp <= 0 ? "yellow" : "#00ffff",
              false
            );
          }
        }

        //距离
        if (app.checkboxList.isDis) {
          drawText(
            objectInfo.dis,
            objectInfo.x,
            objectInfo.y - 47,
            10,
            "#FFF",
            "center",
            true
          );
        }

        //信息
        if (app.checkboxList.isInfo) {
          //队标 名字
          //if (objectInfo.name.length > 7) objectInfo.name = `${objectInfo.name.slice(0, 6)}...`
          drawText(
            objectInfo.team + " " + objectInfo.name,
            objectInfo.x,
            objectInfo.y - 28,
            10,
            "yellow",
            "center",
            true
          );
        }

        // 血条
        if (app.checkboxList.isHP) {
          drawCircular(
            objectInfo.x,
            objectInfo.y - 31,
            Math.ceil(objectInfo.hp),
            11,
            objectInfo.hp <= 30 ? "red" : "#28ff1d",
            5,
            false
          );
        }
      }
    }

    // ********************* 绘图相关 *********************

    //清空画布
    function clearCtx() {
      ctx.clearRect(0, 0, canvasDom.width, canvasDom.height);
    }

    //设置线宽
    function setLineWidth(w) {
      ctx.lineWidth = w;
    }

    //绘制图片测试
    function circleImgTwo(img, x, y, w, h) {
      x *= iosScale;
      y *= iosScale;
      w *= iosScale;
      h *= iosScale;
      ctx.globalAlpha = 0.8;
      ctx.drawImage(img, x, y, w, h);
    }

    //绘制圆形带箭头 中心点xy,半径, 箭头旋转角度, 圆形颜色，箭头颜色（雷达点朝向）
    function drawCMark(x, y, radius, angle, cColor, dColor) {
      x *= iosScale;
      y *= iosScale;
      radius *= iosScale;

      var startAngle = (Math.PI / 180) * (-30 + angle);
      var endAngle = (Math.PI / 180) * (30 + angle);

      //圆形
      ctx.beginPath();
      ctx.fillStyle = cColor;
      ctx.arc(x, y, radius, 0, 360, false);
      ctx.fill();
      ctx.closePath();

      //箭头
      ctx.beginPath();
      ctx.fillStyle = dColor;
      ctx.arc(x, y, radius + radius * 0.15, startAngle, endAngle, false);

      var rx =
        x +
        (x + radius * 1.7 - x) * Math.cos((angle * Math.PI) / 180) -
        (y - y) * Math.sin((angle * Math.PI) / 180);
      var ry =
        y +
        (x + radius * 1.7 - x) * Math.sin((angle * Math.PI) / 180) +
        (y - y) * Math.cos((angle * Math.PI) / 180);

      ctx.lineTo(rx, ry);
      ctx.fill();
      ctx.closePath();
    }

    //绘制三角形，起始点xy，终点xy，颜色，透明度，是否填充
    function drawTriangle(
      x1,
      y1,
      x2,
      y2,
      x3,
      y3,
      color,
      globalAlpha,
      isFill = true
    ) {
      x1 *= iosScale;
      y1 *= iosScale;
      x2 *= iosScale;
      y2 *= iosScale;
      x3 *= iosScale;
      y3 *= iosScale;

      //三角形
      ctx.beginPath(); //开始绘制
      ctx.strokeStyle = color;
      ctx.fillStyle = color;
      ctx.globalAlpha = globalAlpha;
      ctx.moveTo(x1, y1); //开始点，设置x,y
      ctx.lineTo(x2, y2); //途经点，设置x,y
      ctx.lineTo(x3, y3); //最终点，设置x,y
      ctx.closePath(); //闭合路径
      if (isFill) {
        ctx.fill(); //绘制实心
      } else {
        ctx.stroke(); //绘制空心
      }
    }

    //绘制对角矩形 起点xy，矩形宽高，颜色，是否填充（对角方框）
    function drawMyRect(x, y, w, h, color, isFill = true) {
      x *= iosScale;
      y *= iosScale;
      w *= iosScale;
      h *= iosScale;

      ctx.strokeStyle = color;
      ctx.lineWidth = app.xian;

      ctx.beginPath();

      ctx.moveTo(x, y);
      ctx.lineTo(Number(x) + Number(w) / 6, y);
      ctx.closePath();

      ctx.moveTo(x, y);
      ctx.lineTo(x, Number(y) + Number(h / 6));
      ctx.closePath();

      ctx.moveTo(Number(x) + Number(w) - Number(w) / 6, y);
      ctx.lineTo(Number(x) + Number(w), y);
      ctx.closePath();

      ctx.moveTo(Number(x) + Number(w), y);
      ctx.lineTo(Number(x) + Number(w), Number(y) + Number(h / 6));
      ctx.closePath();

      ctx.moveTo(Number(x), Number(y) + Number(h));
      ctx.lineTo(Number(x), Number(y) + Number(h) - Number(h / 6));
      ctx.closePath();

      ctx.moveTo(Number(x), Number(y) + Number(h));
      ctx.lineTo(Number(x) + Number(w) / 6, Number(y) + Number(h));

      ctx.moveTo(Number(x) + Number(w), Number(y) + Number(h));
      ctx.lineTo(Number(x) + Number(w) - w / 6, Number(y) + Number(h));

      ctx.moveTo(Number(x) + Number(w), Number(y) + Number(h));
      ctx.lineTo(Number(x) + Number(w), Number(y) + Number(h) - Number(h / 6));
      ctx.closePath();
      ctx.stroke();
    }

    //绘制图片 图片内容，起点xy，图片宽高（手持贴图）
    function drawImage(png, x, y, w, h) {
      x *= iosScale;
      y *= iosScale;
      w *= iosScale;
      h *= iosScale;

      ctx.beginPath();
      var img = new Image();
      img.src = png;
      //图片加载完成后
      img.onload = function () {
        ctx.drawImage(img, x, y, w, h);
      };
      ctx.closePath();
    }

    //绘制矩形 起点xy，矩形宽高，颜色，透明度，是否填充矩形（队标、名字背景）
    function drawRectangle(x, y, w, h, color, transparency, isFill = true) {
      x *= iosScale;
      y *= iosScale;
      w *= iosScale;
      h *= iosScale;

      ctx.beginPath();
      ctx.fillStyle = color;
      ctx.globalAlpha = transparency;
      ctx.fillRect(x, y, w, h);
      ctx.closePath();
    }

    //绘制线条，起始点xy，终点xy，颜色（雷达线条、射线、3D框线条）
    function drawLine(x1, y1, x2, y2, color, lineWidth) {
      x1 *= iosScale;
      y1 *= iosScale;
      x2 *= iosScale;
      y2 *= iosScale;

      ctx.beginPath();
      ctx.lineWidth = lineWidth;
      ctx.fillStyle = color;
      ctx.strokeStyle = color;
      ctx.moveTo(x1, y1);
      ctx.lineTo(x2, y2);
      ctx.stroke();
      ctx.closePath();
    }

    //绘制圆形 起点xy，圆形弧度，大小，颜色，线宽，是否填充（简洁风格血条、雷达、背敌）
    function drawCircular(x, y, num, size, color, lineWidth, isFill = true) {
      x *= iosScale;
      y *= iosScale;
      size *= iosScale;

      if (num === 100) num = 1;
      else if (num > 0) num = 1 - num / 100;
      const d2a = (n) => (n * Math.PI) / 180;

      ctx.beginPath();
      ctx.lineWidth = lineWidth;
      ctx.arc(x, y, size, d2a(num * 360 - 90), d2a(-90), false);
      if (isFill) {
        ctx.fillStyle = color;
        ctx.fill();
      } else {
        ctx.strokeStyle = color;
        ctx.stroke();
      }
      ctx.closePath();
    }

    //绘制矩形 起点xy，矩形宽高，颜色，是否填充矩形 (方框)
    function drawRect(x, y, w, h, color, isFill = true) {
      x *= iosScale;
      y *= iosScale;
      w *= iosScale;
      h *= iosScale;

      ctx.beginPath();
      ctx.lineWidth = app.xian;
      ctx.strokeStyle = color;
      ctx.fillStyle = color;
      ctx.globalAlpha = 1;
      if (isFill) {
        ctx.fillRect(x, y, w, h);
      } else {
        ctx.strokeRect(x, y, w, h);
      }
      ctx.closePath();
    }

    //绘制圆角矩形，起点xy，矩形宽高，圆角半径，颜色，是否填充矩形
    function drawRoundRect(x, y, w, h, r, color, isFill = true) {
      x *= iosScale;
      y *= iosScale;
      w *= iosScale;
      h *= iosScale;
      r *= iosScale;

      ctx.beginPath();
      ctx.strokeStyle = color;
      ctx.fillStyle = color;
      ctx.globalAlpha = 1;
      if (w < 2 * r) r = w / 2;
      if (h < 2 * r) r = h / 2;
      ctx.beginPath();
      ctx.moveTo(x + r, y);
      ctx.arcTo(x + w, y, x + w, y + h, r);
      ctx.arcTo(x + w, y + h, x, y + h, r);
      ctx.arcTo(x, y + h, x, y, r);
      ctx.arcTo(x, y, x + w, y, r);
      if (isFill) {
        ctx.fill();
      } else {
        ctx.stroke();
      }
      ctx.closePath();
    }

    //绘制文字，文字内容，起点xy，文字大小，文字对齐，颜色，是否填充文字
    function drawText(text, x, y, size, color, textAlign, isFill = true) {
      x *= iosScale;
      y *= iosScale;
      size *= iosScale;

      ctx.beginPath();
      ctx.globalAlpha = 1; //透明度
      ctx.textAlign = textAlign; //文字对齐
      ctx.fillStyle = color;
      ctx.strokeStyle = color;
      ctx.font = size + "px" + fontFamily;
      if (isFill) {
        ctx.fillText(text, x, y + size);
      } else {
        ctx.strokeText(text, x, y + size);
      }
      ctx.closePath();
    }

    // ********************* 内存相关 *********************
    function readInt(addr) {
      return Number(h5gg.getValue(addr, "I32"));
    }

    function readLong(addr) {
      return Number(h5gg.getValue(addr, "I64"));
    }

    function readFloat(addr) {
      return Number(h5gg.getValue(addr, "F32"));
    }

    function isNull(addr) {
      return addr < 0x100000000 || addr > 0x300000000;
    }

    // ********************* UE4相关 *********************
    function RotatorToMatrix(rotation) {
      var radPitch = rotation.Pitch * (Math.PI / 180.0);
      var radYaw = rotation.Yaw * (Math.PI / 180.0);
      var radRoll = rotation.Roll * (Math.PI / 180.0);

      var SP = Math.sin(radPitch);
      var CP = Math.cos(radPitch);
      var SY = Math.sin(radYaw);
      var CY = Math.cos(radYaw);
      var SR = Math.sin(radRoll);
      var CR = Math.cos(radRoll);

      var matrix = new Array(16).fill(0);

      matrix[0] = CP * CY;
      matrix[1] = CP * SY;
      matrix[2] = SP;
      matrix[3] = 0;

      matrix[4] = SR * SP * CY - CR * SY;
      matrix[5] = SR * SP * SY + CR * CY;
      matrix[6] = -SR * CP;
      matrix[7] = 0;

      matrix[8] = -(CR * SP * CY + SR * SY);
      matrix[9] = CY * SR - CR * SP * SY;
      matrix[10] = CR * CP;
      matrix[11] = 0;

      matrix[12] = 0;
      matrix[13] = 0;
      matrix[14] = 0;
      matrix[15] = 1;

      return matrix;
    }

    function vectorDot(lhs, rhs) {
      return lhs.X * rhs.X + lhs.Y * rhs.Y + lhs.Z * rhs.Z;
    }

    function world2Screen(worldLocation, camViewInfo, tempMatrix) {
      // var tempMatrix = RotatorToMatrix(camViewInfo.Rotation);

      var vAxisX = {
        X: tempMatrix[0],
        Y: tempMatrix[1],
        Z: tempMatrix[2],
      };

      var vAxisY = {
        X: tempMatrix[4],
        Y: tempMatrix[5],
        Z: tempMatrix[6],
      };

      var vAxisZ = {
        X: tempMatrix[8],
        Y: tempMatrix[9],
        Z: tempMatrix[10],
      };

      var vDelta = {
        X: worldLocation.X - camViewInfo.Location.X,
        Y: worldLocation.Y - camViewInfo.Location.Y,
        Z: worldLocation.Z - camViewInfo.Location.Z,
      };

      var vTransformed = {
        X: vectorDot(vDelta, vAxisY),
        Y: vectorDot(vDelta, vAxisZ),
        Z: vectorDot(vDelta, vAxisX),
      };

      if (vTransformed.Z < 1.0) {
        vTransformed.Z = 1.0;
      }

      var fov = camViewInfo.FOV;
      var screenCenterX = sWidth / 2.0;
      var screenCenterY = sHeight / 2.0;

      var re = {
        X:
          screenCenterX +
          (vTransformed.X *
            (screenCenterX / Math.tan(fov * (Math.PI / 360.0)))) /
            vTransformed.Z,
        Y:
          screenCenterY -
          (vTransformed.Y *
            (screenCenterX / Math.tan(fov * (Math.PI / 360.0)))) /
            vTransformed.Z,
      };

      return re;
    }

    /***************骨骼函数*******************/
    function getBoneWorldPos(boneTransAddr, c2wMatrix) {
      var boneTrans = {
        Rotation: {
          x: readFloat(boneTransAddr),
          y: readFloat(boneTransAddr + 4),
          z: readFloat(boneTransAddr + 8),
          w: readFloat(boneTransAddr + 12),
        },
        Translation: {
          X: readFloat(boneTransAddr + 16),
          Y: readFloat(boneTransAddr + 20),
          Z: readFloat(boneTransAddr + 24),
          W: readFloat(boneTransAddr + 28),
        },
        Scale3D: {
          X: readFloat(boneTransAddr + 32),
          Y: readFloat(boneTransAddr + 36),
          Z: readFloat(boneTransAddr + 40),
        },
      };
      var boneMatrix = TransformToMatrix(boneTrans);
      return MatrixToVector(MatrixMulti(boneMatrix, c2wMatrix));
    }

    function MatrixToVector(matrix) {
      var Vector3 = {
        X: matrix[3][0],
        Y: matrix[3][1],
        Z: matrix[3][2],
      };
      return Vector3;
    }

    function MatrixMulti(m1, m2) {
      var matrix = createArrTwo(4, 4, 0);
      for (var i = 0; i < 4; i++) {
        for (var j = 0; j < 4; j++) {
          for (var k = 0; k < 4; k++) {
            matrix[i][j] += m1[i][k] * m2[k][j];
          }
        }
      }
      return matrix;
    }

    function TransformToMatrix(transform) {
      var matrix = createArrTwo(4, 4, 0);

      matrix[3][0] = transform.Translation.X;
      matrix[3][1] = transform.Translation.Y;
      matrix[3][2] = transform.Translation.Z;

      var x2 = transform.Rotation.x + transform.Rotation.x;
      var y2 = transform.Rotation.y + transform.Rotation.y;
      var z2 = transform.Rotation.z + transform.Rotation.z;

      var xx2 = transform.Rotation.x * x2;
      var yy2 = transform.Rotation.y * y2;
      var zz2 = transform.Rotation.z * z2;

      matrix[0][0] = (1.0 - (yy2 + zz2)) * transform.Scale3D.X;
      matrix[1][1] = (1.0 - (xx2 + zz2)) * transform.Scale3D.Y;
      matrix[2][2] = (1.0 - (xx2 + yy2)) * transform.Scale3D.Z;

      var yz2 = transform.Rotation.y * z2;
      var wx2 = transform.Rotation.w * x2;
      matrix[2][1] = (yz2 - wx2) * transform.Scale3D.Z;
      matrix[1][2] = (yz2 + wx2) * transform.Scale3D.Y;

      var xy2 = transform.Rotation.x * y2;
      var wz2 = transform.Rotation.w * z2;
      matrix[1][0] = (xy2 - wz2) * transform.Scale3D.Y;
      matrix[0][1] = (xy2 + wz2) * transform.Scale3D.X;

      var xz2 = transform.Rotation.x * z2;
      var wy2 = transform.Rotation.w * y2;
      matrix[2][0] = (xz2 + wy2) * transform.Scale3D.Z;
      matrix[0][2] = (xz2 - wy2) * transform.Scale3D.X;

      matrix[0][3] = 0;
      matrix[1][3] = 0;
      matrix[2][3] = 0;
      matrix[3][3] = 1;

      return matrix;
    }

    function createArrTwo(num1, num2, data) {
      let arr = new Array(num1);
      for (let i = 0; i < num1; ++i) {
        arr[i] = new Array(num2);
        for (let x = 0; x < num2; ++x) {
          arr[i][x] = data;
        }
      }
      return arr;
    }
    /***************骨骼函数*******************/

    cacheTimer = setInterval(function () {
      drawCache();
    }, 1000); //一秒缓存一次

    drawTimer = setInterval(function () {
      if (app.checkboxList.isDraw == "1") {
        console.log("1");
        shadowDraw();

        //计算FPS
        if (!window.fpscount) window.fpscount = 0;
        if (!window.fpstime) window.fpstime = performance.now();
        window.fpscount++;
        if (performance.now() - window.fpstime > 2000) {
          window.fps = window.fpscount;
          window.fpstime = performance.now();
          window.fpscount = 0;
        }
        ctx.textBaseline = "top";
        ctx.textAlign = "center";
        ctx.font = '40px "Arial, sans-serif"';
        ctx.fillStyle = "aqua";

        if (window.fps) ctx.fillText("FPS: " + window.fps, 150, 50);
      } else {
        clearCtx();
      }
    }, app.fps);
  </script>
</html>
